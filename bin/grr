#! /bin/sh

if [ -x /usr/local/bin/ggrep ]; then
    GREP=/usr/local/bin/ggrep
else
    GREP=grep
fi

usage()
{
    echo $(basename $0) '[-C (case-sensitive)] [-a (all dirs and files)] [-h (usage)] [<directory or files>]' >&2
    exit 1
}

IGNORE_CASE=-i
RECURSIVE=-r
IGNORE_DIRS="--exclude-dir=build --exclude-dir=dist"
IGNORE_FILES=""
OPTIONS=""
COLOR=--color

while getopts ":Calv" opt; do
    case $opt in
        C)
            IGNORE_CASE=""
            ;;
        a)
            IGNORE_DIRS=""
            IGNORE_FILES=""
            ;;
        l)
            OPTIONS="$OPTIONS -l"
            ;;
        v)
            OPTIONS="$OPTIONS -v"
            ;;
        h)
            usage
            ;;
        -)
            break
            ;;
        \?)
            echo "Invalid option: -$OPTARG" >&2
            usage
            ;;
    esac
done
shift $((OPTIND-1))

echo "$GREP" $RECURSIVE $OPTIONS $PATTERN "$@"
exec "$GREP" $IGNORE_CASE $RECURSIVE $IGNORE_DIRS $OPTIONS $COLOR "$@"
